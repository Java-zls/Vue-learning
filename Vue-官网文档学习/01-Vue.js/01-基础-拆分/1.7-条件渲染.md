# 1.7 条件渲染

## 目录(Catalog)
- 1.7 条件渲染
    + 1.7.1 `v-if`
        - 1.7.1.1 在 `<template>` 元素上使用 `v-if` 条件渲染分组
        - 1.7.1.2 `v-else`
        - 1.7.1.3 `v-else-if`
        - 1.7.1.4 用 `key` 管理可复用的元素
    + 1.7.2 `v-show` 
    + 1.7.3 `v-if` vs `v-show`
    + 1.7.4 `v-if` 与 `v-for` 一起使用

## 生词(New Words)


## 内容(Content)
### 1.7 条件渲染
#####  1.7.1 `v-if`
- `v-if` 指令用于条件性渲染一块内容. 这块内容只会在指令的表达式返回 `truthy`
  值的时候被渲染. 例如:
  ```html
    <h1 v-if='awesome'>Vue is awesome!</h1>
  ```
  ```js
    data: {
        awesome: true
    }
  ```
  也可以用 `v-else` 添加一个 "else 块":
  ```html
    <h1 v-if="awesome">Vue is awesome!</h1>
    <h1 v-else>Oh no ;-)</h1>
  ```
- 1.7.1.1 在 `<template>` 元素上使用 `v-if` 条件渲染分组
    + 因为 `v-if` 是一个指令, 所以必须将他添加到一个元素上, 但是如果想切换多个元素呢?
      此时可以把一个 `<template>` 元素当做不可见的包裹元素, 并在上面使用 `v-if`.
      最终的渲染结果将不包含 `<template>` 元素.
      ```vue
        <template>
            <div id="app1711" class="default-div">
                <h2>1.7.1.1: 在包裹元素上使用 v-if 条件渲染分组 </h2>
                <template v-if='ok'>
                    <h3>Title: 我是 v-if 模板中的内容</h3>
                    <p>Paragraph 1</p>
                    <p>Paragraph 2</p>
                </template>

                <template v-else>
                    <h3>Title: 我是 v-else 模板中的内容</h3>
                </template>
            </div>
        </template>
        <script>
            export default {
                name: 'Demo1711',
                data() {
                    return {
                        ok: true,
                    }
                }
            }
        </script>
      ```
- 1.7.1.2 `v-else`
  
    + 你可以使用 `v-else` 指令来表示 `v-if` 的 "else 块". 示例同上:
- 1.7.1.3 `v-else-if`
    + `v-else-if` 顾名思义, 充当 `v-if` 的 "else-if 块", 可以连续使用:
      ```html
        <div v-if="type === 'A'"> A </div>
        <div v-else-if="type === 'B'"> B </div>
        <div v-else-if="type === 'C'"> C </div>
        <div v-else> Note A/B/C </div>
      ```
      类似于 `v-else`, `v-else-if` 也必须紧跟在带有 `v-if` 或 `v-else-if`
      的元素之后.
- 1.7.1.4 用 `key` 管理可复用的元素
    + Vue 会尽可能高效地渲染元素, 通常会复用已有元素而不是从头开始渲染.
      这么做除了使 Vue 变得非常快之外, 还有其它一些好处. 例如,
      如果你允许用户在不同的登录方式之间切换:

      见示效果见:
      `../../../vue-document-learning-example/src/components/1.7.1.4.vue`
      ```vue
        <template>
            <div id="app1714" class="default-div">
                <h2>1.7.1.4: 用 key 管理可复用的元素</h2>
                <template v-if="loginType === true">
                    <div class="add-flex">
                        <label>Username:</label>
                        <input placeholder="Enter your username">
                    </div>
                </template>
                <template class="add-flex" v-else>
                    <div class="add-flex">
                        <label>Email:</label>
                        <input placeholder="Enter your email address">
                    </div>
                </template>
                <button @click="loginType = !loginType">Toggle login Type</button>
            </div>
        </template>
        <script>
            export default {
                name: 'Demo1714',
                data() {
                    return {
                        loginType: true
                    }
                },
            }
        </script>
        <style scoped>
            .add-flex {
                display: flex;
                margin-bottom: 10px;
                justify-content: left;
            }
            .add-flex > label {
                flex-basis: 26%;
                display: flex;
                justify-content: left;
                /* - align-items 设置交叉轴为 center 实现文字垂直居中 */
                align-items: center;
            }
            input { width: 200px; }
        </style>
      ```
      在上面的代码中点击按钮切换 `loginType`, 但 `<label>` 和 `<input>`
      不会被重新渲染, Vue 在做切换的时候复用了这两个元素, 大概的原理应该是这样的:
      当我们触发点击事件, Vue 会在后台重新运行并对比两个 `template`, 如果发现
      `v-else` 内的元素是和当前渲染的 `v-if` 中的相同, 就直接利用现有元素,
      但是更新元素上的 `attribute(特性)`, 如果 `v-if` 中有新增和删除元素,
      那就再做相应的操作.
      
      (Notice: 此处我是用模板组件的形式来写的示例, 和 Vue 官网文档是有差别的;
      详情见 [Vue文档](https://cn.vuejs.org/v2/guide/conditional.html),
      官网文档说利用这种方式, 并不会清除用户已经输入的内容, 但是我这个示例却不行,
      不知示例中哪里写的不对, 忘看到的大神能指点迷津!)
      
      上面的示例虽然性能更好, 但与我们开发中需要的情形并不相同, 因为一般情况下,
      `用户名` 和 `邮箱` 输入框内所填写的内容是不相同的,
      我们不希望用户从用户名输入框切换到邮箱输入框后, 里面填写的内容还是存在的
      (tip: 此种说法是按照官网给出的示例来解说的), 所以 Vue
      为你提供了一种可以表示 "这 2 个元素是完全独立的, 不要复用它们" 的方式. 
      我们只需要加一个具有唯一值的 `key` 属性即可: 代码如下(根据上面的示例更改):
      ```html
        <div id="app1714" class="default-div">
            <h2>1.7.1.4: 用 key 管理可复用的元素</h2>
            <template v-if="loginType === true">
                <div class="add-flex">
                    <label>Username:</label>
                    <input placeholder="Enter your username"
                        key="username-input">
                </div>
            </template>
            <template class="add-flex" v-else>
                <div class="add-flex">
                    <label>Email:</label>
                    <input placeholder="Enter your email address"
                        key="email-input">
                </div>
            </template>
            <button @click="loginType = !loginType">Toggle login Type</button>
        </div>
      ```
      **Added**: 运行示例在浏览器的控制台中定位到元素, 点击切换按钮,
      便可以看到浏览器重新渲染 `<label>` 和 `<input>` 的过程.

#####  1.7.2 `v-show` 
- 另一个用于根据条件展示元素的选型是 `v-show` 指令. 用法大致一样:
  ```html
    <h1 v-show='ok'>Hello!</h1>
  ```
  但不同的是带有 `v-show` 的元素始终会被渲染并保留在 DOM 中. `v-show`
  只是**简单地切换元素 CSS 属性的 `display`.**
- **注意:** `v-show` 不支持 `template` 元素, 也不支持 `v-else`.
  示例见: `../../../vue-document-learning-example/src/components/1.7.2.vue`.

#####  1.7.3 `v-if` vs `v-show`
- `v-if` 是 "真正" 的条件渲染,
  因为它会确保在切换过程中条件块内的事件监听器和子组件适当地被销毁和重建.

  `v-if` 也是惰性的: 如果在初始渲染时条件为假, 则什么也不做——直到条件第一次变为真时,
  才会开始渲染条件块.

  相比之下, `v-show` 就简单得多——不管初始条件是什么, 元素总是会被渲染,
  并且只是简单地基于 CSS 进行切换.

  一般来说, `v-if` 有更高的切换开销, 而 `v-show` 有更高的初始渲染开销.
  因此, 如果需要非常频繁地切换, 则使用 `v-show` 较好；如果在运行时条件很少改变,
  则使用 `v-if` 较好. 

#####  1.7.4 `v-if` 与 `v-for` 一起使用
- **不推荐**同时使用 `v-if` 和 `v-for`. 请查阅
  [风格指南](https://cn.vuejs.org/v2/style-guide/) 中
  "避免 v-if 和 v-for 用在一起" 以获得更多信息.

  当 `v-if` 和 `v-for` 一起使用时, `v-for` 具有比 `v-if` 更高的优先级.
  请查阅 `列表渲染指南`(`./1.8-列表渲染.md`) 以获取详细信息.
  

